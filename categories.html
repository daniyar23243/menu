<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–µ–Ω—é</title>
  <link rel="stylesheet" href="categories.css">
</head>

<body>

  <header class="header">
    <button class="back-btn" onclick="goBack()">‚Üê</button>

    <div class="username" id="usernameText">–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!</div>

    <div class="lang-wrapper">
      <button class="lang-btn" onclick="toggleLanguageMenu()">üåê –Ø–∑—ã–∫</button>

      <div class="lang-menu" id="langMenu">
        <button onclick="setLanguage('ru')">      
        <img src="images/ru.png">
      </button>
      <button onclick="setLanguage('en')">
        <img src="images/eng.jpg">
      </button>
      <button onclick="setLanguage('kg')">
        <img src="images/kg.png">
      </div>
    </div>
  </header>

  <h2 class="title">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h2>

  <div class="categories-container">

  </div>


  <script>
    document.getElementById("usernameText").textContent =
      "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, " + (localStorage.getItem("username") || "") + "!";

    function goBack() {
      window.location.href = "index.html";
    }

    function selectCategory(category) {
      localStorage.setItem("category", category);
      window.location.href = "menu.html";
    }

    function toggleLanguageMenu() {
      const menu = document.getElementById("langMenu");
      menu.classList.toggle("show");
    }

    function setLanguage(lang) {
  localStorage.setItem("language", lang);
  toggleLanguageMenu(); // –∑–∞–∫—Ä—ã—Ç—å –º–µ–Ω—é
  updateUI(); // –æ–±–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
  loadCategories(); // –æ–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —è–∑—ã–∫–µ
    }

    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ –±—ç–∫–µ–Ω–¥–∞
function loadCategories() {
  fetch("http://localhost:3000/categories")
    .then(res => res.json())
    .then(categories => {
      const container = document.querySelector(".categories-container");
      container.innerHTML = "";

      const lang = localStorage.getItem("language") || "ru";

      const nameField =
        lang === "ru" ? "name_ru" :
        lang === "en" ? "name_en" :
        lang === "kg" ? "name_kg" : "name_ru";

      categories.forEach(cat => {
        const div = document.createElement("div");
        div.classList.add("category-card");

        div.innerHTML = `
          <img src="${cat.image_url}" alt="">
          <p>${cat[nameField]}</p>
        `;

        div.onclick = () => {
          localStorage.setItem("category_id", cat.id);
          window.location.href = "menu.html";
        };

        container.appendChild(div);
      });
    });
}
    const translations = {
  ru: {
    greeting: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ",
    chooseCategory: "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é",
    language: "–Ø–∑—ã–∫",
  },
  en: {
    greeting: "Hello",
    chooseCategory: "Choose a category",
    language: "Language",
  },
  kg: {
    greeting: "–°–∞–ª–∞–º–∞—Ç—Å—ã–∑–±—ã",
    chooseCategory: "–ö–∞—Ç–µ–≥–æ—Ä–∏—è–Ω—ã —Ç–∞–Ω–¥–∞“£—ã–∑",
    language: "–¢–∏–ª",
  }
};
  function updateUI() {
  const lang = localStorage.getItem("language") || "ru";

  // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
  const username = localStorage.getItem("username") || "";
  document.getElementById("usernameText").textContent =
    `${translations[lang].greeting}, ${username}!`;

  // –ó–∞–≥–æ–ª–æ–≤–æ–∫
  document.querySelector(".title").textContent =
    translations[lang].chooseCategory;

  // –ö–Ω–æ–ø–∫–∞ –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞
  document.querySelector(".lang-btn").textContent =
    `üåê ${translations[lang].language}`;
}
    updateUI();

    loadCategories();
  </script>

</body>

</html>
